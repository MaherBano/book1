openapi: 3.0.3
info:
  title: RAG Chatbot API
  description: API for the RAG-enabled chatbot integrated with Docusaurus documentation
  version: 1.0.0
paths:
  /:
    get:
      summary: Root endpoint
      description: Basic health check to confirm the API is running
      responses:
        '200':
          description: API is running
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "RAG Chatbot API is running!"

  /chat:
    post:
      summary: Process a chat query
      description: Main chat endpoint that processes user queries using the RAG agent
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ChatRequest'
      responses:
        '200':
          description: Successfully processed the query
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ChatResponse'
        '500':
          description: Error processing query
          content:
            application/json:
              schema:
                type: object
                properties:
                  detail:
                    type: string
                    example: "Error processing query: [error details]"

  /health:
    get:
      summary: Health check
      description: Health check endpoint to verify service status
      responses:
        '200':
          description: Service is healthy
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HealthResponse'

  /sessions:
    post:
      summary: Create a new chat session
      description: Creates a new chat session and returns the session ID
      responses:
        '200':
          description: Session created successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  session_id:
                    type: string
                    example: "550e8400-e29b-41d4-a716-446655440000"

  /sessions/{session_id}:
    get:
      summary: Get session history
      description: Retrieve the chat history for a specific session
      parameters:
        - name: session_id
          in: path
          required: true
          schema:
            type: string
          description: The ID of the session to retrieve
      responses:
        '200':
          description: Session history retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  session_id:
                    type: string
                  history:
                    type: array
                    items:
                      $ref: '#/components/schemas/ChatHistoryItem'
                  message_count:
                    type: integer
        '404':
          description: Session not found
          content:
            application/json:
              schema:
                type: object
                properties:
                  detail:
                    type: string
                    example: "Session not found"

  /models:
    get:
      summary: Get model information
      description: Retrieve information about the underlying AI model
      responses:
        '200':
          description: Model information retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  model_name:
                    type: string
                    example: "gemini-2.5-flash"
                  provider:
                    type: string
                    example: "Google Gemini"
                  capabilities:
                    type: array
                    items:
                      type: string
                    example: ["text_generation", "retrieval_augmentation"]
                  features:
                    type: array
                    items:
                      type: string
                    example: ["citations", "confidence_scoring", "context_awareness"]

components:
  schemas:
    ChatRequest:
      type: object
      required:
        - message
      properties:
        message:
          type: string
          description: The user's question or message to the chatbot
          example: "What are the main concepts in chapter 1?"
          minLength: 1
          maxLength: 2000
        context_constraint:
          type: string
          description: Optional context information such as current page or selected text
          example: "Chapter 1: Introduction to AI"
          nullable: true
        session_id:
          type: string
          description: ID of the current chat session for conversation history
          example: "550e8400-e29b-41d4-a716-446655440000"
          nullable: true

    ChatResponse:
      type: object
      required:
        - response
        - citations
        - confidence_score
        - query_id
        - timestamp
      properties:
        response:
          type: string
          description: The AI-generated response to the user's query
          example: "The main concepts in chapter 1 include..."
        citations:
          type: array
          description: List of sources referenced in the response
          items:
            $ref: '#/components/schemas/Citation'
        confidence_score:
          type: number
          description: Confidence score between 0 and 1 indicating how confident the AI is in its response
          example: 0.85
          minimum: 0
          maximum: 1
        query_id:
          type: string
          description: Unique identifier for the query
          example: "query_12345"
        timestamp:
          type: string
          description: ISO 8601 formatted timestamp of when the response was generated
          example: "2023-12-28T10:30:00Z"

    Citation:
      type: object
      required:
        - url
        - chapter
        - section
        - content_preview
        - relevance_score
      properties:
        url:
          type: string
          description: URL or path to the referenced content
          example: "https://example.com/chapter1"
        chapter:
          type: string
          description: The chapter title of the referenced content
          example: "Chapter 1: Introduction to AI"
        section:
          type: string
          description: The specific section within the chapter
          example: "1.1 Basic Concepts"
        content_preview:
          type: string
          description: A short preview of the referenced content
          example: "This section introduces the basic concepts of artificial intelligence..."
        relevance_score:
          type: number
          description: Score between 0 and 1 indicating how relevant this citation is to the query
          example: 0.85
          minimum: 0
          maximum: 1

    HealthResponse:
      type: object
      required:
        - status
        - service
      properties:
        status:
          type: string
          example: "healthy"
        service:
          type: string
          example: "RAG Chatbot API"
        database_status:
          type: string
          example: "connected"
          nullable: true
        document_count:
          type: integer
          example: 150
          nullable: true
        timestamp:
          type: string
          example: "2023-12-28T10:30:00Z"
          nullable: true

    ChatHistoryItem:
      type: object
      required:
        - query
        - response
        - timestamp
      properties:
        query:
          type: string
          description: The user's question in this interaction
          example: "What are neural networks?"
        response:
          type: string
          description: The AI's response to the query
          example: "Neural networks are computing systems..."
        timestamp:
          type: string
          description: ISO 8601 formatted timestamp of the interaction
          example: "2023-12-28T10:25:00Z"